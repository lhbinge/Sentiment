com.plot("wheat")
com.plot("mealies")
com.plot("eggs")
com.plot("s.horses")
install.packages("rprojroot")
getOption(repos)
getOption("repos")
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Sentiment")
#change the working directory
suppressMessages(library(ggplot2))
suppressMessages(library(plyr))
suppressMessages(library(dplyr))
suppressMessages(library(reshape2))
suppressMessages(library(stargazer))
suppressMessages(library(xtable))
suppressMessages(library(scales))
suppressMessages(library(quantmod))
suppressMessages(library(vars))
suppressMessages(library(tseries))
suppressMessages(library(urca))
##=====================##
## READING IN THE DATA ##
##=====================##
datums <- read.csv("dates3.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
datums$Datum <- as.Date(datums$Datum, format = "%Y/%m/%d")
#library(xlsx)
#write.xlsx(BER.M, "check.xlsx")
##=============================
#BER.M <- read.csv("Manufacturing_full.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
#colnames(BER.M)[1:7] <- c("region","id","sector","weight","turnover","factor","surveyQ")
#BER.M$surveyQ <- toupper(BER.M$surveyQ)
#BER.M$sector <- factor(BER.M$sector) #could include labels
#BER.M$id <- factor(BER.M$id)
#BER.M$surveyQ <- factor(BER.M$surveyQ)
##=============================
#Clean regions
#Mode <- function(x) {
#    ux <- na.remove(unique(x))
#    ux[which.max(tabulate(match(x, ux)))]
#}
#foute <- c("2000Q2","2000Q3","2000Q4","2001Q1")
#korrek <- c("1999Q1","1999Q2","1999Q3","1999Q4","2001Q2","2001Q3","2001Q4",
#            "2002Q1","2002Q2","2002Q3","2002Q4","2003Q1")
#for(i in levels(BER.M$id)) {
#    if(!is.na(Mode(BER.M$region[(BER.M$surveyQ %in% korrek) & (BER.M$id == i)]))) {
#        BER.M$region[(BER.M$surveyQ %in% foute) & (BER.M$id == i)] <- Mode(BER.M$region[(BER.M$surveyQ %in% korrek) & (BER.M$id == i)])
#    }
#}
#BER.M$region <- factor(BER.M$region)
#write.csv(man, "check2.csv")
##=============================
BER.M <- read.csv("Manufacturing_corrected.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
colnames(BER.M)[1:7] <- c("region","id","sector","weight","turnover","factor","surveyQ")
BER.M$surveyQ <- toupper(BER.M$surveyQ)
#BER.M$sector <- factor(BER.M$sector) #could include labels
BER.M$id <- factor(BER.M$id)
BER.M$surveyQ <- factor(BER.M$surveyQ)
#Exlcude Latecomers and old questions
BER.M <- BER.M[BER.M$Latecomer == FALSE | is.na(BER.M$Latecomer),]
BER.M <- BER.M[,!grepl("X",colnames(BER.M))]
BER.M <- BER.M[,1:64]
#==============================
# replace 1,2,3 (Up, Same, Down) responses with 1,0,-1
for(i in 8:64) {
BER.M[,i] <- replace(BER.M[,i], BER.M[,i]==2, 0)
BER.M[,i] <- replace(BER.M[,i], BER.M[,i]==3,-1)
}
for(i in 43:49) {
BER.M[,i] <- replace(BER.M[,i], BER.M[,i]==0, 0.5)
BER.M[,i] <- replace(BER.M[,i], BER.M[,i]==-1, 0)
}
##======================##
## CALCULATE INDICATORS ##
##======================##
food <- c(1010, 1011,1013,1019,1020,1021)
textiles <- c(1120,1040,1049,1042,1060,1070)
wood <- c(1109,1110,1080,1081)
chemicals <- c(1130,1140,1149,1219,1220)
glass <- c(1153,1159)
metals <- c(1160,1161,1170,1179,1182,1189)
electrical <- c(1190,1191,1199)
radio <- c(1192,1194)
transport <- c(1200,1201,1209)
furniture <- c(1090,1099)
all <- unique(BER.M$sector)
consumer <- c(1010,1011,1019,1049,1060,1070,1090,1099,1110,1120,1149,1189,1192)
intermediate <- c(1013,1040,1042,1080,1081,1109,1130,1140,1153,1159,1160,1161,
1179,1191,1199,1219)
capital <- c(1170,1181,1182,1189,1190,1194,1200,1201,1209)
streke <- unique(BER.M$region)
ongeweeg <- function(sektor=all,streek=streke) {
man <- BER.M[BER.M$sector %in% sektor & BER.M$region %in% streek,]
sector <- aggregate(man[,(match("surveyQ",colnames(man))+1):ncol(man)], by=list(man$surveyQ), FUN=mean, na.rm=TRUE)
sector <- merge(datums,sector, by.x="Date", by.y="Group.1", all=TRUE)
sector[,-1:-2] <- na.approx(sector[,-1:-2]*100)
return(sector)
}
geweeg <- function(sektor=all,streek=streke) {
weeg <- function(temp) {  #calculate weighted mean for each quarter for all columns
temp <- cbind(factor=temp$factor,temp$factor*temp[(match("surveyQ",colnames(temp))+1):ncol(temp)])
#temp <- colSums(temp, na.rm=TRUE, dims = 1)/sum(temp$factor, na.rm=TRUE)
#calculate the sum(wi*xi)/sum(wi)
temp <- colSums(temp, na.rm=TRUE, dims = 1)/
sapply(colnames(temp), function(x) sum(temp$factor[!is.na(temp[colnames(temp) == x])]))
#weight only by those that responded to a specific question
return(temp)
}
man <- BER.M[BER.M$sector %in% sektor & BER.M$region %in% streek,]
sector <- data.frame()
for(kwartaal in levels(man$surveyQ)) {
sector <- rbind(sector,weeg(man[man$surveyQ==kwartaal,]))
}
sector <- sector *100
sector[,1] <- levels(man$surveyQ)
colnames(sector) <- colnames(man)[-1:-6]
sector <- merge(datums,sector, by.x="Date", by.y="surveyQ", all=TRUE)
#sector <- as.data.frame(t(sapply(levels(man$surveyQ), function(kwartaal) weeg(man[man$surveyQ==kwartaal,]))))
sector[,-1:-2] <- na.approx(sector[,-1:-2])
return(sector)
}
Manufacturing <- geweeg(all)
Manufacturing_u <- ongeweeg(all)
Food <- geweeg(food)
Textiles <- geweeg(textiles)
Wood <- geweeg(wood)
Chemicals <- geweeg(chemicals)
Glass <- geweeg(glass)
Metals <- geweeg(metals)
Electrical <- geweeg(electrical)
Radio <- geweeg(radio)
Elec_radio <- geweeg(c(electrical,radio))
Transport <- geweeg(transport)
Furniture <- geweeg(furniture)
Consumer <- geweeg(consumer)
Intermediate <- geweeg(intermediate)
Capital <- geweeg(capital)
WC <- geweeg(all,1)
KZN <- geweeg(all,5)
GP <- geweeg(all,6)
pub <- read.csv("Manufacturing_BER_Published.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
ref <- read.csv("Ref Series_2.csv", header=TRUE, sep=",",na.strings = "", skipNul = TRUE)
#Published series
indicator_plot <- cbind(Food[,c("Datum","Q1A")],ref[,c("Food.sa")])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g1 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g1 <- g1 + geom_line()
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Food")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g1 <- g1 + theme(legend.position="none")
indicator_plot <- cbind(Textiles[,c("Datum","Q1A")],ref[,c("Textiles.sa")])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g2 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g2 <- g2 + geom_line()
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Textiles")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g2 <- g2 + theme(legend.position="none")
indicator_plot <- cbind(Wood[,c("Datum","Q3A")],ref[,c("Wood.sa")])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g3 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g3 <- g3 + geom_line()
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Wood")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
indicator_plot <- cbind(Chemicals[,c("Datum","Q6A")],ref[,c("Chemical.sa")])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g4 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g4 <- g4 + geom_line()
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Chemicals")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
#Published series
indicator_plot <- cbind(Food[,c("Datum","Q1A")],ref[,c("Food.sa")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g1 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g1 <- g1 + geom_line()
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Food")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g1 <- g1 + theme(legend.position="none")
indicator_plot <- cbind(Textiles[,c("Datum","Q1A")],ref[,c("Textiles.sa")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g2 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g2 <- g2 + geom_line()
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Textiles")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g2 <- g2 + theme(legend.position="none")
indicator_plot <- cbind(Wood[,c("Datum","Q3A")],ref[,c("Wood.sa")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g3 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g3 <- g3 + geom_line()
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Wood")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
indicator_plot <- cbind(Chemicals[,c("Datum","Q6A")],ref[,c("Chemical")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g4 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g4 <- g4 + geom_line()
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Chemicals")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
View(ref)
colSums(ref[,c("Electrical.sa","Radio.sa")])
colSums(ref[,c("Electrical.sa","Radio.sa")],na.rm = TRUE)
rowSums(ref[,c("Electrical.sa","Radio.sa")],na.rm = TRUE)
indicator_plot <- cbind(Elec_radio[,c("Datum","Q1A")],rowSums(ref[,c("Electrical.sa","Radio.sa")],na.rm = TRUE))
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g3 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g3 <- g3 + geom_line()
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Wood")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g3
ref$Elec_Radio <- rowSums(ref[,c("Electrical.sa","Radio.sa")],na.rm = TRUE)
ref$Elec_Radio <- rowSums(ref[,c("Electrical.sa","Radio.sa")])
ref$Elec_Radio <- rowMeans(ref[,c("Electrical.sa","Radio.sa")])
indicator_plot <- cbind(Elec_radio[,c("Datum","Q1A")],ref[,c("Elec_Radio")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g3 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g3 <- g3 + geom_line()
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Wood")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g3
indicator_plot <- cbind(Glass[,c("Datum","Q1A")],ref[,c("Glass.sa")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g1 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g1 <- g1 + geom_line()
g1 <- g1 + ylab("Indicator") + xlab("")
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + ggtitle("Glass")
g1 <- g1 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g1 <- g1 + theme(legend.title=element_blank())
g1 <- g1 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g1 <- g1 + theme(legend.position="none")
indicator_plot <- cbind(Metals[,c("Datum","Q1A")],ref[,c("Metals.sa")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g2 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g2 <- g2 + geom_line()
g2 <- g2 + ylab("") + xlab("")
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + ggtitle("Metals")
g2 <- g2 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g2 <- g2 + theme(legend.title=element_blank())
g2 <- g2 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g2 <- g2 + theme(legend.position="none")
ref$Elec_Radio <- rowMeans(ref[,c("Electrical.sa","Radio.sa")])
indicator_plot <- cbind(Elec_radio[,c("Datum","Q1A")],ref[,c("Elec_Radio")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g3 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g3 <- g3 + geom_line()
g3 <- g3 + ylab("Indicator") + xlab("")
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + ggtitle("Elec_Radio")
g3 <- g3 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g3 <- g3 + theme(legend.title=element_blank())
g3 <- g3 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g3 <- g3 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
indicator_plot <- cbind(Transport[,c("Datum","Q1A")],ref[,c("Transport.sa")])
indicator_plot[,-1] <- scale(indicator_plot[,-1])
colnames(indicator_plot) <- c("Date","Microdata","StatsSA")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g4 <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g4 <- g4 + geom_line()
g4 <- g4 + ylab("") + xlab("")
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + ggtitle("Transport")
g4 <- g4 + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g4 <- g4 + theme(legend.title=element_blank())
g4 <- g4 + theme(legend.position="bottom",plot.margin=unit(c(-0.5,0.4,0,0.4), "cm"))
g4 <- g4 + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
library(gridExtra)
grid.arrange(g1, g2, g3, g4, ncol=2, nrow =2)
indicator_plot <- cbind(Furniture[,c("Datum","Q1A","Q3A")],
ref[,c("Furniture.sa","Furniture_all.sa")])
colnames(indicator_plot)[1] <- c("Date") #,"Q4:Microdata","Q4:Published")
indicator_plot[,-1] <- scale(indicator_plot[,-1])
plot <- melt(indicator_plot, id="Date")  # convert to long format
g <- ggplot(data=plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank())
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
corstarsl(indicator_plot[,-1])
source("corstarsl.R")
corstarsl(indicator_plot[,-1])
source("corstars1.R")
indicator_plot <- cbind(Food[,c("Q1A")],ref[,c("Food")])
corstarsl(indicator_plot)
View(indicator_plot)
corstarsl(indicator_plot[-1:-28,])
corstarsl(indicator_plot[-1:-28,])
indicator_plot <- cbind(Food[,c("Datum","Q1A")],ref[,c("Food")])
corstarsl(indicator_plot[,-1])
corstarsl(indicator_plot[,-1])
xt <- corstarsl(indicator_plot[,-1])
View(xt)
xt <- corstarsl(indicator_plot[,-1])[2,]
indicator_plot1 <- corstarsl(cbind(Food[,c("Datum","Q1A")],ref[,c("Food")])[,-1])[2,]
x2 <- corstarsl(cbind(Textiles[,c("Datum","Q1A")],ref[,c("Textiles")])[,-1])[2,]
x <- cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
x1 <- corstarsl(cbind(Food[,c("Datum","Q1A")],ref[,c("Food")])[,-1])[2,]
x2 <- corstarsl(cbind(Textiles[,c("Datum","Q1A")],ref[,c("Textiles")])[,-1])[2,]
x3 <- corstarsl(cbind(Wood[,c("Datum","Q3A")],ref[,c("Wood.sa")])[,-1])[2,]
x4 <- corstarsl(cbind(Chemicals[,c("Datum","Q6A")],ref[,c("Chemical")])[,-1])[2,]
x5 <- corstarsl(cbind(Glass[,c("Datum","Q1A")],ref[,c("Glass.sa")])[,-1])[2,]
x6 <- corstarsl(cbind(Metals[,c("Datum","Q1A")],ref[,c("Metals.sa")])[,-1])[2,]
x7 <- corstarsl(cbind(Elec_radio[,c("Datum","Q1A")],ref[,c("Elec_Radio")])[,-1])[2,]
x8 <- corstarsl(cbind(Transport[,c("Datum","Q1A")],ref[,c("Transport.sa")])[,-1])[2,]
x9 <- corstarsl(cbind(Furniture[,c("Datum","Q1A")],ref[,c("Furniture_all.sa")])[,-1])[2,]
x <- cbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
View(x)
x <- rbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
x1 <- corstarsl(cbind(Food[,c("Datum","Q1A")],ref[,c("Food")])[,-1])
x2 <- corstarsl(cbind(Textiles[,c("Datum","Q1A")],ref[,c("Textiles")])[,-1])
x3 <- corstarsl(cbind(Wood[,c("Datum","Q3A")],ref[,c("Wood.sa")])[,-1])
x4 <- corstarsl(cbind(Chemicals[,c("Datum","Q6A")],ref[,c("Chemical")])[,-1])
x5 <- corstarsl(cbind(Glass[,c("Datum","Q1A")],ref[,c("Glass.sa")])[,-1])
x6 <- corstarsl(cbind(Metals[,c("Datum","Q1A")],ref[,c("Metals.sa")])[,-1])
x7 <- corstarsl(cbind(Elec_radio[,c("Datum","Q1A")],ref[,c("Elec_Radio")])[,-1])
x8 <- corstarsl(cbind(Transport[,c("Datum","Q1A")],ref[,c("Transport.sa")])[,-1])
x9 <- corstarsl(cbind(Furniture[,c("Datum","Q1A")],ref[,c("Furniture_all.sa")])[,-1])
x <- rbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
View(x3)
x1 <- corstarsl(cbind(Food[,c("Datum","Q1A")],ref[,c("Food")])[,-1])
x2 <- corstarsl(cbind(Textiles[,c("Datum","Q1A")],ref[,c("Textiles")])[,-1])
x3 <- corstarsl(cbind(Wood[,c("Datum","Q1A")],ref[,c("Wood.sa")])[,-1])
x4 <- corstarsl(cbind(Chemicals[,c("Datum","Q1A")],ref[,c("Chemical")])[,-1])
x5 <- corstarsl(cbind(Glass[,c("Datum","Q1A")],ref[,c("Glass.sa")])[,-1])
x6 <- corstarsl(cbind(Metals[,c("Datum","Q1A")],ref[,c("Metals.sa")])[,-1])
x7 <- corstarsl(cbind(Elec_radio[,c("Datum","Q1A")],ref[,c("Elec_Radio")])[,-1])
x8 <- corstarsl(cbind(Transport[,c("Datum","Q1A")],ref[,c("Transport.sa")])[,-1])
x9 <- corstarsl(cbind(Furniture[,c("Datum","Q1A")],ref[,c("Furniture_all.sa")])[,-1])
x <- rbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
x1 <- corstarsl(cbind(Food[,c("Datum","Q1A","Q3A")],ref[,c("Food")])[,-1])
View(x1)
source("corstarsl.R")
x1 <- corstarsl(cbind(Food[,c("Datum","Q1A","Q3A")],ref[,c("Food")])[,-1])
x2 <- corstarsl(cbind(Textiles[,c("Datum","Q1A","Q3A")],ref[,c("Textiles")])[,-1])
x3 <- corstarsl(cbind(Wood[,c("Datum","Q1A","Q3A")],ref[,c("Wood.sa")])[,-1])
x4 <- corstarsl(cbind(Chemicals[,c("Datum","Q1A","Q3A")],ref[,c("Chemical")])[,-1])
x5 <- corstarsl(cbind(Glass[,c("Datum","Q1A","Q3A")],ref[,c("Glass.sa")])[,-1])
x6 <- corstarsl(cbind(Metals[,c("Datum","Q1A","Q3A")],ref[,c("Metals.sa")])[,-1])
x7 <- corstarsl(cbind(Elec_radio[,c("Datum","Q1A","Q3A")],ref[,c("Elec_Radio")])[,-1])
x8 <- corstarsl(cbind(Transport[,c("Datum","Q1A","Q3A")],ref[,c("Transport.sa")])[,-1])
x9 <- corstarsl(cbind(Furniture[,c("Datum","Q1A","Q3A")],ref[,c("Furniture_all.sa")])[,-1])
x <- rbind(x1,x2,x3,x4,x5,x6,x7,x8,x9)
x <- rbind(x1[3,],x2[3,],x3[3,],x4[3,],x5[3,],x6[3,],x7[3,],x8[3,],x9[3,])
row.names(x) <- c("Food","Textiles","Wood","Chemicals","Glass","Metals",
"Elec_radio","Transport","Furniture")
xt <- xtable(x)
print(xt, "latex",comment=FALSE,scalebox = 0.6)
indicator_plot <- cbind(Manufacturing[,c("Datum","Q1A","Q3A")],
ref[,c("RTotal_Sales.sa","Total_Vol.sa","Total.sa")])
colnames(indicator_plot)[1] <- c("Date","Q1A","Q3A","SARB:Sales","SARB:Volume",
"StatsSA:Volume")
indicator_plot[,-1] <- scale(indicator_plot[,-1])
plot <- melt(indicator_plot, id="Date")  # convert to long format
g <- ggplot(data=plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank())
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
indicator_plot <- cbind(Manufacturing[,c("Datum","Q1A","Q3A")],
ref[,c("RTotal_Sales.sa","Total_Vol.sa","Total.sa")])
colnames(indicator_plot) <- c("Date","Q1A","Q3A","SARB:Sales","SARB:Volume","StatsSA:Volume")
indicator_plot[,-1] <- scale(indicator_plot[,-1])
plot <- melt(indicator_plot, id="Date")  # convert to long format
g <- ggplot(data=plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank())
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
source("corstarsl.R")
xt <- xtable(corstarsl(indicator_plot[,-1]))
print(xt, "latex",comment=FALSE,scalebox = 0.6)
BERplot <- aggregate(BER.M$id, by=list(BER.M$surveyQ,BER.M$region), FUN = length)
BERplot$Group.1 <- as.Date(as.yearqtr(BERplot$Group.1, format = "%YQ%q"))
g <- ggplot(BERplot, aes(x=Group.1, y=x,fill=Group.2))
g <- g + geom_bar(stat="identity")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + scale_fill_discrete(name="Region")
g <- g + scale_y_continuous(labels=comma)
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + ylab("Number of Respondents")
g <- g + xlab("Date")
g
BERplot <- aggregate(BER.M$id, by=list(BER.M$surveyQ,BER.M$region), FUN = length)
BERplot$Group.1 <- as.Date(as.yearqtr(BERplot$Group.1, format = "%YQ%q"))
View(BERplot)
g <- ggplot(BERplot, aes(x=Group.1, y=x,fill=Group.2))
g <- g + geom_bar(stat="identity")
g
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g
g <- g + scale_fill_discrete(name="Region")
r
g
BERplot <- aggregate(BER.M$id, by=list(BER.M$surveyQ,BER.M$region), FUN = length)
BERplot$Group.1 <- as.Date(as.yearqtr(BERplot$Group.1, format = "%YQ%q"))
BERplot$Group.2 <- factor(BERplot$Group.2)
g <- ggplot(BERplot, aes(x=Group.1, y=x,fill=Group.2))
g <- g + geom_bar(stat="identity")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + scale_fill_discrete(name="Region")
g <- g + scale_y_continuous(labels=comma)
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + ylab("Number of Respondents")
g <- g + xlab("Date")
g
indicator_plot <- cbind(Manufacturing_u[,c("Datum","Q20")],pub[,c("Total_Q20")])
colnames(indicator_plot) <- c("Date","Q4:Microdata","Q4:Published")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank())
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
indicator_plot <- cbind(Manufacturing[,c("Datum","Q20")],pub[,c("Total_Q20")])
colnames(indicator_plot) <- c("Date","Q4:Microdata","Q4:Published")
indicator_plot <- melt(indicator_plot, id="Date")  # convert to long format
g <- ggplot(data=indicator_plot,aes(x=Date, y=value, group=variable, colour=variable))
g <- g + geom_line()
g <- g + ylab("Indicator") + xlab("")
g <- g + theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5))
g <- g + theme(legend.title=element_blank())
g <- g + scale_x_date(labels = date_format("%Y"),breaks = date_breaks("year"))
g <- g + theme(legend.position="bottom")
g
ccf(cbind(Manufacturing[,c("Q20")],pub[,c("Total_Q20")]), na.action = na.pass)
ccf(Manufacturing[,c("Q20")],pub[,c("Total_Q20")], na.action = na.pass)
ccf(Manufacturing[,c("Q1A")],ref[,c("Total.sa")], na.action = na.pass)
ccf(Food[,c("Q1A")],ref[,c("Food.sa")], na.action = na.pass)
ccf(Food[,c("Q1A")],ref[,c("Food")], na.action = na.pass)
ccf(Textiles[,c("Q1A")],ref[,c("Textiles")], na.action = na.pass)
ccf(Wood[,c("Q1A")],ref[,c("Wood")], na.action = na.pass)
