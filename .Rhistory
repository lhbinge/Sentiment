pacf(kingtimeseriesdiff1, lag.max=20) # plot a partial correlogram
pacf(kingtimeseriesdiff1, lag.max=20, plot=FALSE) # get the partial autocorrelation values
auto.arima(kings)
volcanodust <- scan("http://robjhyndman.com/tsdldata/annual/dvi.dat", skip=1)
volcanodustseries <- ts(volcanodust,start=c(1500))
plot.ts(volcanodustseries)
acf(volcanodustseries, lag.max=20) # plot a correlogram
acf(volcanodustseries, lag.max=20, plot=FALSE) # get the values of the autocorrelations
pacf(volcanodustseries, lag.max=20)
pacf(volcanodustseries, lag.max=20, plot=FALSE)
auto.arima(volcanodust)
auto.arima(volcanodust,ic="bic")
kingstimeseriesarima <- arima(kingstimeseries, order=c(0,1,1)) # fit an ARIMA(0,1,1) model
kingstimeseriesarima
forecast.Arima(kingstimeseriesarima,h=5, level=c(99.5))
kingstimeseriesforecasts <- forecast.Arima(kingstimeseriesarima, h=5)
kingstimeseriesforecasts
plot.forecast(kingstimeseriesforecasts)
acf(kingstimeseriesforecasts$residuals, lag.max=20)
Box.test(kingstimeseriesforecasts$residuals, lag=20, type="Ljung-Box")
plot.ts(kingstimeseriesforecasts$residuals) # make time plot of forecast errors
plotForecastErrors(kingstimeseriesforecasts$residuals) # make a histogram
volcanodustseriesarima <- arima(volcanodustseries, order=c(2,0,0))
volcanodustseriesarima
volcanodustseriesforecasts <- forecast.Arima(volcanodustseriesarima, h=31)
volcanodustseriesforecasts
plot.forecast(volcanodustseriesforecasts)
volcanodustseries
volcanodustseriesforecasts
plot(volcanodustseries$fitted)
plot(volcanodustarima)
plot(volcanodustseriesarima$x,col="red")
lines(fitted(volcanodustseriesarima),col="blue")
volcanodustseriesarima <- Arima(volcanodustseries, order=c(2,0,0))
plot(volcanodustseriesarima$x,col="red")
lines(fitted(volcanodustseriesarima),col="blue")
plot.forecast(volcanodustseriesforecasts)
acf(volcanodustseriesforecasts$residuals, lag.max=20)
Box.test(volcanodustseriesforecasts$residuals, lag=20, type="Ljung-Box")
plot.ts(volcanodustseriesforecasts$residuals) # make time plot of forecast errors
plotForecastErrors(volcanodustseriesforecasts$residuals) # make a histogram
mean(volcanodustseriesforecasts$residuals)
data(AirPassengers)
AP <- AirPassengers
AP
plot(AP, ylab = "Passengers (1000's)")
layout(1:2)
plot(aggregate(AP))
boxplot(AP ~ cycle(AP))
plot(cbind(Elec.ts, Beer.ts, Choc.ts))
AP.elec <- ts.intersect(AP, Elec.ts)
plot(as.vector(AP), as.vector(Elec),
xlab = "Air passengers / 1000's",
ylab = "Electricity production / MWh")
Z.92.96 <- window(Z.ts, start = c(1992, 1), end = c(1996, 1))
Global.annual <- aggregate(Global.ts, FUN = mean)
##=========================================================================================##
## -------------------------------- SENTIMENT ---------------------------------------------##
##=========================================================================================##
##=====================##
## READING IN THE DATA ##
##=====================##
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(stargazer)
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Data")
BER <- read.csv("Manufacturing.csv", header=TRUE, sep=";",na.strings = "", skipNul = TRUE)
BER$region <- as.factor(BER$region) #sit levels in
BER$sector <- as.factor(BER$sector) #sit levels in
# replace 1,2,3 (Up, Same, Down) responses with 1,0,-1
for(i in 8:62) {
BER[,i] <- replace(BER[,i], BER[,i]==2, 0)
BER[,i] <- replace(BER[,i], BER[,i]==3,-1)
}
BER$Q19 <- replace(BER$Q19, BER$Q19==0,-1) # replace 1,0 (Yes, No) responses with 1,-1
BER$Q20 <- replace(BER$Q20, BER$Q20==0,-1) # replace 1,0 (Satisfactory, Unsatisfactory) with 1,-1
##======================##
## CALCULATE INDICATORS ##
##======================##
# calculation check
#t1 <- na.omit(subset(BER$Q20,BER$survey=="01Q2"))
#fr.increase <- length(subset(t1,t1==1))/length(t1)
#fr.decrease <- length(subset(t1,t1==-1))/length(t1)
#con <- fr.increase-fr.decrease
indicators <- aggregate(BER$Q20, by=list(BER$survey), FUN=mean, na.rm=TRUE)
colnames(indicators) <- c("Date","Conf.cc")
indicators <- cbind(indicators, Conf_fl = aggregate(BER$Q31, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Act_prod = aggregate(BER$Q3A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Conf_prod = aggregate(BER$Q3P, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Act_GBC = aggregate(BER$Q7A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Conf_GBC = aggregate(BER$Q7P, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Invest = aggregate(BER$Q10A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Empl = aggregate(BER$Q8A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
altBER <- BER
altBER$Q8A <- replace(altBER$Q8A, altBER$Q8A==-1,1) # replace -1 (Down) responses with 1
indicators <- cbind(indicators, Empl_turn = aggregate(altBER$Q8A, by=list(altBER$survey), FUN=mean, na.rm=TRUE)[,2])
# calculation check
#t1 <- na.omit(subset(BER$Q31,BER$survey=="01Q3"))
#fr.increase <- length(subset(t1,t1==1))/length(t1)
#fr.decrease <- length(subset(t1,t1==-1))/length(t1)
#unc <- sqrt(fr.increase+fr.decrease-(fr.increase-fr.decrease)^2)
se <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x))*(length(na.omit(x))-1)) #adjust for (n-1)
indicators <- cbind(indicators, Uncert_fl = aggregate(BER$Q31, by=list(BER$survey), FUN=se)[,2])
indicators <- cbind(indicators, Uncert_prod = aggregate(BER$Q3P, by=list(BER$survey), FUN=se)[,2])
indicators <- cbind(indicators, Uncert_GBC = aggregate(BER$Q7P, by=list(BER$survey), FUN=se)[,2])
#The expectations of firms in question 31 in period t are compared to the realization of firms
#in question 7A in period t+4.
BER$counter <- as.numeric(BER$survey)
data <- subset(BER, BER$id==35077)
for(i in 1:49) {
data$uncert[i] <- data$Q7A[i+4] - data$Q31[i]
}
View(data)
for(i in 1:(nrow(data))) {
data$uncert[i] <- data$Q7A[i+4] - data$Q31[i]
}
rm(data$uncert)
View(indicators)
exp.error <- indicators[,1]
exp.error <- as.data.frame(indicators[,1])
?merge
data <- subset(BER, BER$id==35077)
for(i in 1:(nrow(data))) {
data$error[i] <- data$Q7A[i+4] - data$Q31[i]
}
data <- data[,c("survey","error")]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
View(exp.error)
exp.error <- indicators[,c(1,11)]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
data <- subset(BER, BER$id==35077)
?sort
data <- subset(BER, BER$id==35077)
data <- data[order("counter"),]
data[order("counter"),]
data <- subset(BER, BER$id==35077)
order("counter")
data <- data[with(order(counter)),]
data <- data[with(order("counter")),]
data[with(order("counter")),]
data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==35077)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(i in 1:(nrow(data))) {
exp.error$error[i] <- data$Q7A[i+4] - data$Q31[i]
}
for(i in 1:(nrow(data))) {
exp.error$error[i] <- exp.error$Q7A[i+4] - exp.error$Q31[i]
}
errors <- indicators[,c(1,11)]
k<-35077
errors <- cbind(errors, k=exp.error$error)
View(errors)
errors <- cbind(errors, "k"=exp.error$error)
errors <- cbind(errors, id=exp.error$error)
errors <- cbind(errors, id[1]=exp.error$error)
errors <- indicators[,c(1,11)]
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==35077)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(i in 1:(nrow(data))) {
exp.error$error[i] <- exp.error$Q7A[i+4] - exp.error$Q31[i]
}
errors <- cbind(errors, exp.error$error)
colnames(errors[3]) <- k
k
colnames(errors[3]) <- k
colnames(errors[3]) <- exp.error$id
colnames(errors[3]) <- "k"
colnames(errors[3])
colnames(errors[3]) <- "k"
#The expectations of firms in question 31 in period t are compared to the realization of firms
colnames(errors[3]) <- c("k")
as.character(k)
errors <- cbind(errors, k)
errors <- cbind(errors, k=exp.error$error)
errors <- cbind(errors, "k"=exp.error$error)
errors <- cbind(errors, as.character(k)=exp.error$error)
colnames(errors[3]) <- as.character(k)
colnames(errors[,3]) <- as.character(k)
colnames(errors)[3] <- as.character(k)
levels(BER$id)
str(BER$id)
levels(factor(BER$id))
errors <- indicators[,c(1,11)]
tel <- 2
for(k in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==k)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(i in 1:(nrow(data))) {
exp.error$error[i] <- exp.error$Q7A[i+4] - exp.error$Q31[i]
}
errors <- cbind(errors, exp.error$error)
colnames(errors)[tel] <- as.character(k)
}
length(levels(factor(BER$id)))
View(BER)
sum(duplicated(BER[,c("id","survey")]))
duplicated(BER[,c("id","survey")])
##=========================================================================================##
## -------------------------------- SENTIMENT ---------------------------------------------##
##=========================================================================================##
##=====================##
## READING IN THE DATA ##
##=====================##
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(stargazer)
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Data")
BER <- read.csv("Manufacturing.csv", header=TRUE, sep=";",na.strings = "", skipNul = TRUE)
BER$region <- as.factor(BER$region) #sit levels in
BER$sector <- as.factor(BER$sector) #sit levels in
# replace 1,2,3 (Up, Same, Down) responses with 1,0,-1
for(i in 8:62) {
BER[,i] <- replace(BER[,i], BER[,i]==2, 0)
BER[,i] <- replace(BER[,i], BER[,i]==3,-1)
}
BER$Q19 <- replace(BER$Q19, BER$Q19==0,-1) # replace 1,0 (Yes, No) responses with 1,-1
BER$Q20 <- replace(BER$Q20, BER$Q20==0,-1) # replace 1,0 (Satisfactory, Unsatisfactory) with 1,-1
##======================##
## CALCULATE INDICATORS ##
##======================##
# calculation check
#t1 <- na.omit(subset(BER$Q20,BER$survey=="01Q2"))
#fr.increase <- length(subset(t1,t1==1))/length(t1)
#fr.decrease <- length(subset(t1,t1==-1))/length(t1)
#con <- fr.increase-fr.decrease
indicators <- aggregate(BER$Q20, by=list(BER$survey), FUN=mean, na.rm=TRUE)
colnames(indicators) <- c("Date","Conf.cc")
indicators <- cbind(indicators, Conf_fl = aggregate(BER$Q31, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Act_prod = aggregate(BER$Q3A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Conf_prod = aggregate(BER$Q3P, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Act_GBC = aggregate(BER$Q7A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Conf_GBC = aggregate(BER$Q7P, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Invest = aggregate(BER$Q10A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Empl = aggregate(BER$Q8A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
altBER <- BER
altBER$Q8A <- replace(altBER$Q8A, altBER$Q8A==-1,1) # replace -1 (Down) responses with 1
indicators <- cbind(indicators, Empl_turn = aggregate(altBER$Q8A, by=list(altBER$survey), FUN=mean, na.rm=TRUE)[,2])
# calculation check
#t1 <- na.omit(subset(BER$Q31,BER$survey=="01Q3"))
#fr.increase <- length(subset(t1,t1==1))/length(t1)
#fr.decrease <- length(subset(t1,t1==-1))/length(t1)
#unc <- sqrt(fr.increase+fr.decrease-(fr.increase-fr.decrease)^2)
se <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x))*(length(na.omit(x))-1)) #adjust for (n-1)
indicators <- cbind(indicators, Uncert_fl = aggregate(BER$Q31, by=list(BER$survey), FUN=se)[,2])
indicators <- cbind(indicators, Uncert_prod = aggregate(BER$Q3P, by=list(BER$survey), FUN=se)[,2])
indicators <- cbind(indicators, Uncert_GBC = aggregate(BER$Q7P, by=list(BER$survey), FUN=se)[,2])
sum(duplicated(BER[,c("id","survey")]))
#The expectations of firms in question 31 in period t are compared to the realization of firms
#in question 7A in period t+4.
errors <- indicators[,c(1,11)]
tel <- 2
for(k in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==k)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(i in 1:(nrow(data))) {
exp.error$error[i] <- exp.error$Q7A[i+4] - exp.error$Q31[i]
}
errors <- cbind(errors, exp.error$error)
colnames(errors)[tel] <- as.character(k)
}
k <- 1033
k <- 10033
errors <- indicators[,c(1,11)]
tel <- 2
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==k)
levels(factor(BER$id))
nrow(exp.error)
errors <- indicators[,c(1,11)]
tel <- 2
for(i in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==i)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(t in 1:(nrow(exp.error))) {
exp.error$error[t] <- exp.error$Q7A[t+4] - exp.error$Q31[t]
}
errors <- cbind(errors, exp.error$error)
colnames(errors)[tel] <- as.character(i)
}
View(errors)
colnames(errors)
errors$42762
summary(errors)
summary(errors$42762)
errors[,1000]
?t
t(errors)
errorst <- t(errors)
View(errorst)
errors <- errors[,-2]
View(BER)
View(errorst)
aggregate(errors, by=list(errors$Date), FUN=se)
errors <- errors[,-1]
?sapply
sapply(errors, FUN=sd)
sapply(errors, FUN=sd, na.rm=TRUE)
?apply
transform(errors, SD=apply(errors,1,se,na.rm = TRUE))
transform(errors, SD=apply(errors,1,sd,na.rm = TRUE))
uncert <- transform(errors, SD=apply(errors,1,sd,na.rm = TRUE))
View(uncert)
uncert <- transform(errors, SD=apply(errors,1,sd,na.rm = TRUE))[,ncol(errors)+1]
indicators <- cbind(indicators, Uncert_ee = uncert))
indicators <- cbind(indicators, Uncert_ee = uncert)
View(indicators)
errors <- indicators[,c(1,11)]
tel <- 2
sum(duplicated(BER[,c("id","survey")]))
for(i in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==i)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(t in 1:(nrow(exp.error))) {
exp.error$error[t] <- exp.error$Q7A[t+4] - exp.error$Q31[t]
}
errors <- cbind(errors, exp.error$error)
colnames(errors)[tel] <- as.character(i)
}
uncert <- transform(errors, SD=apply(errors[,c(-1,-2)],1,sd,na.rm = TRUE))[,ncol(errors)+1]
uncert <- transform(errors, SD=apply(errors[,c(-1,-2)],1,sd,na.rm = TRUE))[,c(1,ncol(errors)+1)]
View(uncert)
indicators <- cbind(indicators, Uncert_ee = uncert[,2])
indicators <- indicators[,-15]
errors <- indicators[,c(1,11)]
tel <- 2
for(i in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==i)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(t in 1:(nrow(exp.error))) {
exp.error$error[t] <- exp.error$Q3A[t+1] - exp.error$Q3P[t]
}
errors <- cbind(errors, exp.error$error)
colnames(errors)[tel] <- as.character(i)
}
uncert <- transform(errors, SD=apply(errors[,c(-1,-2)],1,sd,na.rm = TRUE))[,c(1,ncol(errors)+1)]
indicators <- cbind(indicators, Uncert_prod = uncert[,2])
View(errors)
#The expectations of firms in question 7P in period t are compared to the realization of firms
#in question 7A in period t+1.
errors <- indicators[,c(1,11)]
tel <- 2
for(i in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==i)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(t in 1:(nrow(exp.error))) {
exp.error$error[t] <- exp.error$Q7A[t+1] - exp.error$Q7P[t]
}
errors <- cbind(errors, exp.error$error)
colnames(errors)[tel] <- as.character(i)
}
uncert <- transform(errors, SD=apply(errors[,c(-1,-2)],1,sd,na.rm = TRUE))[,c(1,ncol(errors)+1)]
indicators <- cbind(indicators, Uncert_ee.GBC = uncert[,2])
##=========================================================================================##
## -------------------------------- SENTIMENT ---------------------------------------------##
##=========================================================================================##
##=====================##
## READING IN THE DATA ##
##=====================##
library(ggplot2)
library(plyr)
library(dplyr)
library(reshape2)
library(stargazer)
setwd("C:\\Users\\Laurie\\OneDrive\\Documents\\BING\\BER Confidence Surveys\\Data")
BER <- read.csv("Manufacturing.csv", header=TRUE, sep=";",na.strings = "", skipNul = TRUE)
BER$region <- as.factor(BER$region) #sit levels in
BER$sector <- as.factor(BER$sector) #sit levels in
# replace 1,2,3 (Up, Same, Down) responses with 1,0,-1
for(i in 8:62) {
BER[,i] <- replace(BER[,i], BER[,i]==2, 0)
BER[,i] <- replace(BER[,i], BER[,i]==3,-1)
}
BER$Q19 <- replace(BER$Q19, BER$Q19==0,-1) # replace 1,0 (Yes, No) responses with 1,-1
BER$Q20 <- replace(BER$Q20, BER$Q20==0,-1) # replace 1,0 (Satisfactory, Unsatisfactory) with 1,-1
##======================##
## CALCULATE INDICATORS ##
##======================##
# calculation check
#t1 <- na.omit(subset(BER$Q20,BER$survey=="01Q2"))
#fr.increase <- length(subset(t1,t1==1))/length(t1)
#fr.decrease <- length(subset(t1,t1==-1))/length(t1)
#con <- fr.increase-fr.decrease
indicators <- aggregate(BER$Q20, by=list(BER$survey), FUN=mean, na.rm=TRUE)
colnames(indicators) <- c("Date","Conf.cc")
indicators <- cbind(indicators, Conf_fl = aggregate(BER$Q31, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Act_prod = aggregate(BER$Q3A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Conf_prod = aggregate(BER$Q3P, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Act_GBC = aggregate(BER$Q7A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Conf_GBC = aggregate(BER$Q7P, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Invest = aggregate(BER$Q10A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
indicators <- cbind(indicators, Empl = aggregate(BER$Q8A, by=list(BER$survey), FUN=mean, na.rm=TRUE)[,2])
altBER <- BER
altBER$Q8A <- replace(altBER$Q8A, altBER$Q8A==-1,1) # replace -1 (Down) responses with 1
indicators <- cbind(indicators, Empl_turn = aggregate(altBER$Q8A, by=list(altBER$survey), FUN=mean, na.rm=TRUE)[,2])
# calculation check
#t1 <- na.omit(subset(BER$Q31,BER$survey=="01Q3"))
#fr.increase <- length(subset(t1,t1==1))/length(t1)
#fr.decrease <- length(subset(t1,t1==-1))/length(t1)
#unc <- sqrt(fr.increase+fr.decrease-(fr.increase-fr.decrease)^2)
se <- function(x) sqrt(var(x,na.rm=TRUE)/length(na.omit(x))*(length(na.omit(x))-1)) #adjust for (n-1)
indicators <- cbind(indicators, Uncert_fl = aggregate(BER$Q31, by=list(BER$survey), FUN=se)[,2])
indicators <- cbind(indicators, Uncert_prod = aggregate(BER$Q3P, by=list(BER$survey), FUN=se)[,2])
indicators <- cbind(indicators, Uncert_GBC = aggregate(BER$Q7P, by=list(BER$survey), FUN=se)[,2])
sum(duplicated(BER[,c("id","survey")]))
#The expectations of firms in question 31 in period t are compared to the realization of firms
#in question 7A in period t+4.
#Also compare the expectations of firms in questions 3P & 7P in period t to the realizations
#in questions 3A & 7A in period t+1.
errors1 <- indicators[,c(1,11)]
errors2 <- indicators[,c(1,11)]
errors3 <- indicators[,c(1,11)]
tel <- 2
for(i in levels(factor(BER$id))){
tel <- tel + 1
#BER$counter <- as.numeric(BER$survey)
exp.error <- indicators[,c(1,11)]
data <- subset(BER, BER$id==i)
#data <- data[order(data$counter),]
exp.error <- merge(exp.error, data, by.x="Date",by.y="survey", all.x = TRUE)
for(t in 1:(nrow(exp.error))) {
exp.error$error1[t] <- exp.error$Q7A[t+4] - exp.error$Q31[t]
exp.error$error2[t] <- exp.error$Q3A[t+1] - exp.error$Q3P[t]
exp.error$error3[t] <- exp.error$Q7A[t+1] - exp.error$Q7P[t]
}
errors1 <- cbind(errors1, exp.error$error1)
colnames(errors1)[tel] <- as.character(i)
errors2 <- cbind(errors2, exp.error$error2)
colnames(errors2)[tel] <- as.character(i)
errors3 <- cbind(errors3, exp.error$error3)
colnames(errors3)[tel] <- as.character(i)
}
uncert <- transform(errors1, SD=apply(errors1[,c(-1,-2)],1,sd,na.rm = TRUE))[,c(1,ncol(errors1)+1)]
indicators <- cbind(indicators, Uncert_ee = uncert[,2])
uncert <- transform(errors2, SD=apply(errors2[,c(-1,-2)],1,sd,na.rm = TRUE))[,c(1,ncol(errors2)+1)]
indicators <- cbind(indicators, Uncert_ee.prod = uncert[,2])
uncert <- transform(errors3, SD=apply(errors3[,c(-1,-2)],1,sd,na.rm = TRUE))[,c(1,ncol(errors3)+1)]
indicators <- cbind(indicators, Uncert_ee.GBC = uncert[,2])
View(errors3)
missing <- function(x) apply(is.na(x),1,sum)
aggregate(BER, by=list(BER$survey), FUN=missing)
missing <- function(x) apply(is.na(x),2,sum)
aggregate(BER, by=list(BER$survey), FUN=missing)
apply(is.na(x),2,sum)
apply(is.na(BER),2,sum)
aggregate(BER, by=list(BER$survey), FUN=is.na)
missing <- function(x) sum(is.na(x))
aggregate(BER, by=list(BER$survey), FUN=missing)
missing <- function(x) sum(is.na(x))/nrow(x)
NNR <- aggregate(BER, by=list(BER$survey), FUN=missing)
View(NNR)
View(NNR)
str(NNR)
NNR <- as.data.frame(NNR)
View(NNR)
missing <- function(x) sum(is.na(x))
NNR <- aggregate(BER, by=list(BER$survey), FUN=missing)
View(NNR)
for(j in levels(BER$survey)) {
data <- subset(BER,BER$survey==j)
NNR[j,] <- sum(is.na(BER))
}
View(NNR)
str(NNR)
NNR$Q1A
for(j in levels(BER$survey)) {
data <- subset(BER,BER$survey==j)
NNR[j,] <- sum(is.na(data))
}
View(NNR)
NNR$Q1A
levels(BER$survey)
for(j in levels(BER$survey)) {
data <- subset(BER,BER$survey==j)
NNR <- sum(is.na(data))
}
